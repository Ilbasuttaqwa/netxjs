(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[796],{8213:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/absensi",function(){return s(1784)}])},1774:function(e,a,s){"use strict";s.d(a,{I:function(){return l}});var t=s(5893),r=s(7294),n=s(8660);let l=(0,r.forwardRef)((e,a)=>{let{className:s,type:r,label:l,error:i,helperText:d,leftIcon:c,rightIcon:o,id:m,...x}=e,u=m||"input-".concat(Math.random().toString(36).substr(2,9));return(0,t.jsxs)("div",{className:"w-full",children:[l&&(0,t.jsx)("label",{htmlFor:u,className:"form-label",children:l}),(0,t.jsxs)("div",{className:"relative",children:[c&&(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:c})}),(0,t.jsx)("input",{type:r,id:u,className:(0,n.cn)("form-input-modern",c&&"pl-12",o&&"pr-12",i&&"border-red-400 focus:border-red-500 focus:ring-red-500 shadow-glow-rose","focus:shadow-glow transition-all duration-300",s),ref:a,...x}),o&&(0,t.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:o})})]}),i&&(0,t.jsx)("p",{className:"form-error",children:i}),d&&!i&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:d})]})});l.displayName="Input"},1784:function(e,a,s){"use strict";s.r(a);var t=s(5893),r=s(7294),n=s(9008),l=s.n(n),i=s(5770),d=s(1163),c=s(6458),o=s(4607),m=s(3903),x=s(7245),u=s(1774),h=s(1429),p=s(3431),g=s(9711),j=s(2294),f=s(9537),w=s(4001),y=s(3950),v=s(3146),b=s(7530),N=s(6162);a.default=()=>{let{user:e,isAuthenticated:a,isLoading:s}=(0,i.a)(),n=(0,d.useRouter)(),{addToast:k}=(0,o.p)(),[_,E]=(0,r.useState)([]),[S,C]=(0,r.useState)([]),[Z,L]=(0,r.useState)([]),[A,M]=(0,r.useState)(!0),[T,z]=(0,r.useState)(1),[I,O]=(0,r.useState)(1),[R,D]=(0,r.useState)(!1),[B,F]=(0,r.useState)({tanggal_mulai:"",tanggal_selesai:"",cabang_id:"",karyawan_id:"",status:""}),[H,K]=(0,r.useState)(!1),[W,G]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s||a?!s&&a&&(null==e?void 0:e.role)!=="admin"&&n.push("/dasbor"):n.push("/login")},[a,s,e,n]),(0,r.useEffect)(()=>{a&&(null==e?void 0:e.role)==="admin"&&P()},[a,e,T]);let P=async()=>{try{M(!0);let[e,a,s]=await Promise.all([c.rG.getAbsensi({page:T,...B,cabang_id:B.cabang_id?parseInt(B.cabang_id):void 0,karyawan_id:B.karyawan_id?parseInt(B.karyawan_id):void 0}),c.T5.getKaryawan(),c.DD.getCabang()]);e.success&&e.data?(E(e.data.data||[]),O(e.data.last_page||1)):(E([]),O(1)),a.success&&a.data?C(Array.isArray(a.data)?a.data:a.data.data||[]):C([]),s.success&&s.data?L(Array.isArray(s.data)?s.data:s.data.data||[]):L([])}catch(e){k({type:"error",title:"Error",message:e.message||"Gagal memuat data"})}finally{M(!1)}},U=async()=>{try{K(!0);let e=await c.rG.export(B);if(e.success&&e.data){let a=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=a,s.setAttribute("download","laporan-absensi-".concat(new Date().toISOString().split("T")[0],".xlsx")),document.body.appendChild(s),s.click(),s.remove(),k({type:"success",title:"Berhasil",message:"Laporan berhasil diunduh"})}else throw Error(e.message)}catch(e){k({type:"error",title:"Error",message:e.message||"Gagal mengunduh laporan"})}finally{K(!1)}},J=e=>{switch(e){case"hadir":return(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"Hadir"]});case"terlambat":return(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-warning-100 text-warning-800",children:[(0,t.jsx)(p.Z,{className:"h-3 w-3 mr-1"}),"Terlambat"]});case"alpha":return(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-danger-100 text-danger-800",children:[(0,t.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Alpha"]});case"izin":return(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"Izin"]});case"sakit":return(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),"Sakit"]});default:return(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e})}},V=e=>new Date(e).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),X=e=>e?e.substring(0,5):"-";return s||!a||(null==e?void 0:e.role)!=="admin"?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"loading-spinner w-8 h-8"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l(),{children:[(0,t.jsx)("title",{children:"Laporan Absensi - AFMS"}),(0,t.jsx)("meta",{name:"description",content:"Laporan data absensi karyawan"})]}),(0,t.jsx)(m.Z,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-white shadow-sm rounded-lg p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Laporan Absensi"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Lihat dan kelola data absensi karyawan"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>G(!W),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,t.jsx)("span",{children:"Aksi"}),(0,t.jsx)(j.Z,{className:"h-4 w-4 transition-transform ".concat(W?"rotate-180":"")})]}),W&&(0,t.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[(0,t.jsxs)("button",{onClick:()=>{D(!R),G(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-50 flex items-center gap-3 border-b border-gray-100",children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 text-blue-600"}),(0,t.jsx)("span",{className:"text-gray-700",children:"Filter"})]}),(0,t.jsxs)("button",{onClick:()=>{U(),G(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-50 flex items-center gap-3",disabled:H,children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 text-green-600"}),(0,t.jsx)("span",{className:"text-gray-700",children:H?"Mengexport...":"Export Excel"})]})]})]})]})}),R&&(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter Data"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsx)(u.I,{label:"Tanggal Mulai",type:"date",value:B.tanggal_mulai,onChange:e=>F({...B,tanggal_mulai:e.target.value})}),(0,t.jsx)(u.I,{label:"Tanggal Selesai",type:"date",value:B.tanggal_selesai,onChange:e=>F({...B,tanggal_selesai:e.target.value})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cabang"}),(0,t.jsxs)("select",{value:B.cabang_id,onChange:e=>F({...B,cabang_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"",children:"Semua Cabang"}),Z.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nama_cabang},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Karyawan"}),(0,t.jsxs)("select",{value:B.karyawan_id,onChange:e=>F({...B,karyawan_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"",children:"Semua Karyawan"}),S.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nama},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,t.jsxs)("select",{value:B.status,onChange:e=>F({...B,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"",children:"Semua Status"}),(0,t.jsx)("option",{value:"hadir",children:"Hadir"}),(0,t.jsx)("option",{value:"terlambat",children:"Terlambat"}),(0,t.jsx)("option",{value:"alpha",children:"Alpha"}),(0,t.jsx)("option",{value:"izin",children:"Izin"}),(0,t.jsx)("option",{value:"sakit",children:"Sakit"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 mt-4",children:[(0,t.jsx)(x.z,{variant:"outline",onClick:()=>{F({tanggal_mulai:"",tanggal_selesai:"",cabang_id:"",karyawan_id:"",status:""}),z(1),P()},children:"Atur Ulang"}),(0,t.jsx)(x.z,{onClick:()=>{z(1),P(),D(!1)},children:"Terapkan Filter"})]})]}),(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Karyawan"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jam Masuk"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jam Keluar"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterangan"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:A?[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"animate-pulse flex items-center",children:[(0,t.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-16"})]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"animate-pulse h-4 bg-gray-200 rounded w-32"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"animate-pulse h-4 bg-gray-200 rounded w-16"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"animate-pulse h-4 bg-gray-200 rounded w-16"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"animate-pulse h-6 bg-gray-200 rounded w-16"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"animate-pulse h-4 bg-gray-200 rounded w-24"})})]},a)):0===_.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"Tidak ada data absensi"})}):_.map(e=>{var a,s,r;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"h-10 w-10 bg-primary-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(y.Z,{className:"h-5 w-5 text-primary-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null===(a=e.user)||void 0===a?void 0:a.nama_pegawai)||"Tidak Diketahui"}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,t.jsx)(v.Z,{className:"h-3 w-3 mr-1"}),(null===(r=e.user)||void 0===r?void 0:null===(s=r.cabang)||void 0===s?void 0:s.nama_cabang)||"Tidak Diketahui"]})]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-900",children:V(e.tanggal)}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.tanggal})]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-900",children:X(e.jam_masuk)})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-900",children:X(e.jam_keluar)})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:J(e.status)}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("span",{className:"text-sm text-gray-900",children:e.keterangan||"-"})})]},e.id)})})]})}),I>1&&(0,t.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[(0,t.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,t.jsx)(x.z,{variant:"outline",onClick:()=>z(Math.max(1,T-1)),disabled:1===T,children:"Sebelumnya"}),(0,t.jsx)(x.z,{variant:"outline",onClick:()=>z(Math.min(I,T+1)),disabled:T===I,children:"Selanjutnya"})]}),(0,t.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:["Halaman ",(0,t.jsx)("span",{className:"font-medium",children:T})," dari"," ",(0,t.jsx)("span",{className:"font-medium",children:I})]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[(0,t.jsx)(x.z,{variant:"outline",onClick:()=>z(Math.max(1,T-1)),disabled:1===T,children:"Sebelumnya"}),(0,t.jsx)(x.z,{variant:"outline",onClick:()=>z(Math.min(I,T+1)),disabled:T===I,children:"Selanjutnya"})]})})]})]})]})]})})]})}},1429:function(e,a,s){"use strict";var t=s(7294);let r=t.forwardRef(function(e,a){let{title:s,titleId:r,...n}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},n),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});a.Z=r},2294:function(e,a,s){"use strict";var t=s(7294);let r=t.forwardRef(function(e,a){let{title:s,titleId:r,...n}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},n),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))});a.Z=r},4001:function(e,a,s){"use strict";var t=s(7294);let r=t.forwardRef(function(e,a){let{title:s,titleId:r,...n}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},n),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))});a.Z=r},3431:function(e,a,s){"use strict";var t=s(7294);let r=t.forwardRef(function(e,a){let{title:s,titleId:r,...n}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},n),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))});a.Z=r},9537:function(e,a,s){"use strict";var t=s(7294);let r=t.forwardRef(function(e,a){let{title:s,titleId:r,...n}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},n),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))});a.Z=r},9711:function(e,a,s){"use strict";var t=s(7294);let r=t.forwardRef(function(e,a){let{title:s,titleId:r,...n}=e;return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},n),s?t.createElement("title",{id:r},s):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});a.Z=r}},function(e){e.O(0,[474,795,903,888,774,179],function(){return e(e.s=8213)}),_N_E=e.O()}]);