(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[207],{3713:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/devices",function(){return a(4332)}])},4332:function(e,t,a){"use strict";a.r(t);var r=a(5893),s=a(7294),n=a(1163),i=a(5770),l=a(4607),c=a(1429),d=a(9711),o=a(3431),u=a(3681),m=a(1182),x=a(4991),g=a(3781);t.default=()=>{let e=(0,n.useRouter)(),{user:t,isLoading:a}=(0,i.a)(),{addToast:p}=(0,l.p)(),[h,f]=(0,s.useState)([]),[v,b]=(0,s.useState)([]),[y,j]=(0,s.useState)(!0),[w,N]=(0,s.useState)(!1),[k,_]=(0,s.useState)(null),[E,C]=(0,s.useState)(1),[S,L]=(0,s.useState)(1),[Z,D]=(0,s.useState)(""),[M,R]=(0,s.useState)(""),[A,O]=(0,s.useState)(""),[B,F]=(0,s.useState)(""),[P,T]=(0,s.useState)({device_id:"",nama:"",tipe:"fingerprint",cabang_id:"",ip_address:"",port:"",lokasi:"",keterangan:"",firmware_version:""});(0,s.useEffect)(()=>{if(!a&&(!t||"admin"!==t.role)){e.push("/login");return}t&&(W(),I())},[t,a,E,Z,M,A,B]);let W=async()=>{try{let e=new URLSearchParams({page:E.toString(),limit:"10",...Z&&{search:Z},...M&&{status:M},...A&&{cabang_id:A},...B&&{tipe:B}}),t=await fetch("/api/devices?".concat(e)),a=await t.json();a.success?(f(a.data),L(a.pagination.total_pages)):p({type:"error",title:"Error",message:a.message||"Failed to fetch devices"})}catch(e){p({type:"error",title:"Error",message:"Error fetching devices"})}finally{j(!1)}},I=async()=>{try{let e=await fetch("/api/cabang"),t=await e.json();t.success&&b(t.data)}catch(e){}},q=async e=>{e.preventDefault(),j(!0);try{let e=k?"/api/devices/".concat(k.id):"/api/devices",t=await fetch(e,{method:k?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,cabang_id:parseInt(P.cabang_id),port:P.port?parseInt(P.port):null})}),a=await t.json();a.success?(p({type:"success",title:"Success",message:a.message}),N(!1),X(),W()):p({type:"error",title:"Error",message:a.message||"Operation failed"})}catch(e){p({type:"error",title:"Error",message:"Error saving device"})}finally{j(!1)}},U=e=>{var t;_(e),T({device_id:e.device_id,nama:e.nama,tipe:e.tipe,cabang_id:e.cabang_id.toString(),ip_address:e.ip_address||"",port:(null===(t=e.port)||void 0===t?void 0:t.toString())||"",lokasi:e.lokasi||"",keterangan:e.keterangan||"",firmware_version:e.firmware_version||""}),N(!0)},H=async e=>{if(confirm('Are you sure you want to delete device "'.concat(e.nama,'"?')))try{let t=await fetch("/api/devices/".concat(e.id),{method:"DELETE"}),a=await t.json();a.success?(p({type:"success",title:"Success",message:a.message}),W()):p({type:"error",title:"Error",message:a.message||"Failed to delete device"})}catch(e){p({type:"error",title:"Error",message:"Error deleting device"})}},X=()=>{T({device_id:"",nama:"",tipe:"fingerprint",cabang_id:"",ip_address:"",port:"",lokasi:"",keterangan:"",firmware_version:""}),_(null)},z=e=>{switch(e){case"aktif":return(0,r.jsx)(c.Z,{className:"h-5 w-5 text-green-500"});case"nonaktif":return(0,r.jsx)(d.Z,{className:"h-5 w-5 text-red-500"});case"maintenance":return(0,r.jsx)(o.Z,{className:"h-5 w-5 text-yellow-500"});default:return(0,r.jsx)(d.Z,{className:"h-5 w-5 text-gray-500"})}},G=e=>{switch(e){case"aktif":return"bg-green-100 text-green-800";case"nonaktif":return"bg-red-100 text-red-800";case"maintenance":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return a||y?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Device Management"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage fingerprint devices and their configurations"})]}),(0,r.jsxs)("button",{onClick:()=>{X(),N(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5"}),"Add Device"]})]}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",placeholder:"Search devices...",value:Z,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:M,onChange:e=>R(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"aktif",children:"Active"}),(0,r.jsx)("option",{value:"nonaktif",children:"Inactive"}),(0,r.jsx)("option",{value:"maintenance",children:"Maintenance"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:B,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Types"}),(0,r.jsx)("option",{value:"fingerprint",children:"Fingerprint"}),(0,r.jsx)("option",{value:"face",children:"Face Recognition"}),(0,r.jsx)("option",{value:"card",children:"Card Reader"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:A,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Branches"}),v.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nama_cabang},e.id))]})}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{onClick:()=>{D(""),R(""),F(""),O(""),C(1)},className:"w-full px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:"Clear Filters"})})]})}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device Info"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Network"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Sync"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.nama}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.device_id," â€¢ ",e.tipe]}),e.lokasi&&(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:["\uD83D\uDCCD ",e.lokasi]})]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.cabang.nama}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.cabang.alamat})]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[e.ip_address||"N/A",e.port&&":".concat(e.port)]}),e.firmware_version&&(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["FW: ",e.firmware_version]})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[z(e.status),(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(G(e.status)),children:e.status})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.last_sync?new Date(e.last_sync).toLocaleString():"Never"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>U(e),className:"text-blue-600 hover:text-blue-900",title:"Edit",children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>H(e),className:"text-red-600 hover:text-red-900",title:"Delete",children:(0,r.jsx)(x.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===h.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(g.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No devices found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding a new device."})]})]}),S>1&&(0,r.jsxs)("div",{className:"flex justify-center items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>C(e=>Math.max(e-1,1)),disabled:1===E,className:"px-3 py-2 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,r.jsxs)("span",{className:"px-3 py-2 text-sm text-gray-700",children:["Page ",E," of ",S]}),(0,r.jsx)("button",{onClick:()=>C(e=>Math.min(e+1,S)),disabled:E===S,className:"px-3 py-2 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]}),w&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:k?"Edit Device":"Add New Device"}),(0,r.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Device ID *"}),(0,r.jsx)("input",{type:"text",required:!0,value:P.device_id,onChange:e=>T({...P,device_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., FP001",disabled:!!k})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Device Name *"}),(0,r.jsx)("input",{type:"text",required:!0,value:P.nama,onChange:e=>T({...P,nama:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Main Entrance Scanner"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Device Type *"}),(0,r.jsxs)("select",{required:!0,value:P.tipe,onChange:e=>T({...P,tipe:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"fingerprint",children:"Fingerprint"}),(0,r.jsx)("option",{value:"face",children:"Face Recognition"}),(0,r.jsx)("option",{value:"card",children:"Card Reader"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch *"}),(0,r.jsxs)("select",{required:!0,value:P.cabang_id,onChange:e=>T({...P,cabang_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select Branch"}),v.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nama_cabang},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IP Address"}),(0,r.jsx)("input",{type:"text",value:P.ip_address,onChange:e=>T({...P,ip_address:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 192.168.1.100"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),(0,r.jsx)("input",{type:"number",value:P.port,onChange:e=>T({...P,port:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 4370"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,r.jsx)("input",{type:"text",value:P.lokasi,onChange:e=>T({...P,lokasi:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Main Entrance, Floor 1"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Firmware Version"}),(0,r.jsx)("input",{type:"text",value:P.firmware_version,onChange:e=>T({...P,firmware_version:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., v2.1.0"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,r.jsx)("textarea",{value:P.keterangan,onChange:e=>T({...P,keterangan:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Additional notes about this device..."})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{N(!1),X()},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:y,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:y?"Saving...":k?"Update Device":"Add Device"})]})]})]})})})]})})}},1429:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=s},3431:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))});t.Z=s},1182:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))});t.Z=s},3681:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});t.Z=s},4991:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});t.Z=s},3781:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))});t.Z=s},9711:function(e,t,a){"use strict";var r=a(7294);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=s}},function(e){e.O(0,[888,774,179],function(){return e(e.s=3713)}),_N_E=e.O()}]);