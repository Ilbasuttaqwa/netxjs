(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{1301:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/device-monitor",function(){return t(97)}])},3939:function(e,s,t){"use strict";t.d(s,{u:function(){return l}});var a=t(5893);t(7294);var r=t(8660);let l=e=>{let{isOpen:s,onClose:t,title:l,children:n,className:i}=e;return s?(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),(0,a.jsxs)("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl sm:max-w-lg",children:[l&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:l}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:(0,r.cn)("",i),children:n})]})]})}):null};s.Z=l},97:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(7294),l=t(9008),n=t.n(l),i=t(1163),d=t(3903),c=t(7245),x=t(3939),o=t(8660);s.default=()=>{let e=(0,i.useRouter)(),[s,t]=(0,r.useState)(null),[l,m]=(0,r.useState)(!0),[h,u]=(0,r.useState)(null),[g,j]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!0),[y,f]=(0,r.useState)(5e3),[N,p]=(0,r.useState)(new Date);(0,r.useEffect)(()=>{if(!localStorage.getItem("token")){e.push("/login");return}},[e]);let w=(0,r.useCallback)(async()=>{try{let e=localStorage.getItem("token"),s=await fetch("/api/devices/monitor",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();e.success&&(t(e.data),p(new Date))}}catch(e){}finally{m(!1)}},[]);(0,r.useEffect)(()=>{w()},[w]),(0,r.useEffect)(()=>{if(!v)return;let e=setInterval(()=>{w()},y);return()=>clearInterval(e)},[v,y,w]);let _=e=>{switch(e){case"online":return"bg-green-100 text-green-800 border-green-200";case"offline":default:return"bg-gray-100 text-gray-800 border-gray-200";case"error":return"bg-red-100 text-red-800 border-red-200";case"maintenance":return"bg-yellow-100 text-yellow-800 border-yellow-200"}},k=e=>{switch(e){case"online":return"\uD83D\uDFE2";case"offline":return"\uD83D\uDD34";case"error":return"⚠️";case"maintenance":return"\uD83D\uDD27";default:return"⚪"}},D=e=>{if(!e)return"Never";let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/6e4);return t<1?"Just now":t<60?"".concat(t,"m ago"):t<1440?"".concat(Math.floor(t/60),"h ago"):s.toLocaleDateString()},C=e=>{u(e),j(!0)};return l?(0,a.jsx)(d.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})})}):(0,a.jsxs)(d.Z,{children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:"Device Monitor - AFMS"}),(0,a.jsx)("meta",{name:"description",content:"Real-time device monitoring"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Device Monitor"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Real-time monitoring sistem fingerprint"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Auto Refresh:"}),(0,a.jsx)("button",{onClick:()=>b(!v),className:(0,o.cn)("px-3 py-1 rounded text-sm font-medium transition-colors",v?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-800 border border-gray-200"),children:v?"ON":"OFF"})]}),(0,a.jsx)(c.z,{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"\uD83D\uDD04 Refresh"})]})]}),s&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:s.summary.total_devices}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Devices"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.summary.online_devices}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Online"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:s.summary.offline_devices}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Offline"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:s.summary.error_devices}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Error"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:s.summary.maintenance_devices}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Maintenance"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:s.summary.total_attendance_today}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Attendance Today"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Last refresh: ",N.toLocaleTimeString(),v&&" (Auto refresh every ".concat(y/1e3,"s)")]}),s&&(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:s.devices.map(e=>(0,a.jsxs)("div",{onClick:()=>C(e),className:"bg-white p-4 rounded-lg shadow border hover:shadow-md transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-lg",children:k(e.status)}),(0,a.jsx)("span",{className:(0,o.cn)("px-2 py-1 rounded text-xs font-medium border",_(e.status)),children:e.status.toUpperCase()})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.cabang.kode_cabang})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.nama}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.device_id})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsxs)("div",{children:["\uD83D\uDCCD ",e.lokasi]}),(0,a.jsxs)("div",{children:["\uD83C\uDF10 ",e.ip_address,":",e.port]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Attendance Today:"}),(0,a.jsx)("span",{className:"font-medium",children:e.today_attendance_count})]}),e.temperature&&(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Temperature:"}),(0,a.jsxs)("span",{className:(0,o.cn)("font-medium",e.temperature>70?"text-red-600":"text-green-600"),children:[e.temperature,"\xb0C"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 pt-2 border-t",children:["Last sync: ",D(e.last_sync)]})]})]},e.id))}),(0,a.jsx)(x.u,{isOpen:g,onClose:()=>j(!1),title:"Device Details - ".concat(null==h?void 0:h.nama),children:h&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Device ID"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.device_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsx)("span",{className:(0,o.cn)("inline-flex px-2 py-1 rounded text-xs font-medium border",_(h.status)),children:h.status.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.cabang.nama_cabang})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.lokasi})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"IP Address"}),(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[h.ip_address,":",h.port]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Firmware"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.firmware_version||"Unknown"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Employee Count"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.employee_count})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Storage Usage"}),(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[h.storage_usage,"%"]})]}),h.temperature&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Temperature"}),(0,a.jsxs)("div",{className:(0,o.cn)("text-sm font-medium",h.temperature>70?"text-red-600":"text-green-600"),children:[h.temperature,"\xb0C"]})]}),h.memory_usage&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Memory Usage"}),(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[h.memory_usage,"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Today Attendance"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.today_attendance_count})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Total Attendance"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:h.total_attendance_count})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Sync"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:D(h.last_sync)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:new Date(h.created_at).toLocaleString()})]})]}),h.error_message&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-red-700",children:"Error Message"}),(0,a.jsx)("div",{className:"text-sm text-red-600",children:h.error_message})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-2 pt-4",children:(0,a.jsx)(c.z,{onClick:()=>j(!1),className:"bg-gray-500 hover:bg-gray-600 text-white",children:"Close"})})]})})]})]})}}},function(e){e.O(0,[474,795,903,888,774,179],function(){return e(e.s=1301)}),_N_E=e.O()}]);