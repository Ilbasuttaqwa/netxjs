"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/devices/sync";
exports.ids = ["pages/api/devices/sync"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdevices%2Fsync&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdevices%5Csync.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdevices%2Fsync&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdevices%5Csync.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_devices_sync_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\devices\\sync.ts */ \"(api)/./pages/api/devices/sync.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_devices_sync_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_devices_sync_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/devices/sync\",\n        pathname: \"/api/devices/sync\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_devices_sync_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmRldmljZXMlMkZzeW5jJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNkZXZpY2VzJTVDc3luYy50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUMyRDtBQUMzRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2FmbXMtbmV4dGpzLz8yNzI1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcZGV2aWNlc1xcXFxzeW5jLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZGV2aWNlcy9zeW5jXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZGV2aWNlcy9zeW5jXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdevices%2Fsync&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdevices%5Csync.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth-middleware.ts":
/*!********************************!*\
  !*** ./lib/auth-middleware.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withAdminAuth: () => (/* binding */ withAdminAuth),\n/* harmony export */   withAuth: () => (/* binding */ withAuth)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction withAuth(handler, requiredRoles) {\n    return async (req, res)=>{\n        try {\n            // Get token from Authorization header\n            const authHeader = req.headers.authorization;\n            if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n                return res.status(401).json({\n                    message: \"No token provided\"\n                });\n            }\n            const token = authHeader.substring(7); // Remove 'Bearer ' prefix\n            // Verify JWT token\n            const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, \"your-super-secret-jwt-key-here-development\" || 0);\n            if (!decoded || !decoded.id) {\n                return res.status(401).json({\n                    message: \"Invalid token\"\n                });\n            }\n            // Add user info to request\n            req.user = {\n                id: decoded.id,\n                userId: parseInt(decoded.id) || 1,\n                email: decoded.email || \"\",\n                name: decoded.name || \"\",\n                role: decoded.role || \"admin\"\n            };\n            // Check role if required\n            if (requiredRoles) {\n                const allowedRoles = Array.isArray(requiredRoles) ? requiredRoles : [\n                    requiredRoles\n                ];\n                if (!allowedRoles.includes(req.user.role)) {\n                    return res.status(403).json({\n                        message: \"Insufficient permissions\"\n                    });\n                }\n            }\n            // Call the actual handler\n            return await handler(req, res);\n        } catch (error) {\n            console.error(\"Auth middleware error:\", error);\n            return res.status(401).json({\n                message: \"Invalid token\"\n            });\n        }\n    };\n}\nfunction withAdminAuth(handler) {\n    return withAuth(handler, \"admin\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC1taWRkbGV3YXJlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDK0I7QUFZeEIsU0FBU0MsU0FDZEMsT0FBMkUsRUFDM0VDLGFBQWlDO0lBRWpDLE9BQU8sT0FBT0MsS0FBMkJDO1FBQ3ZDLElBQUk7WUFDRixzQ0FBc0M7WUFDdEMsTUFBTUMsYUFBYUYsSUFBSUcsT0FBTyxDQUFDQyxhQUFhO1lBQzVDLElBQUksQ0FBQ0YsY0FBYyxDQUFDQSxXQUFXRyxVQUFVLENBQUMsWUFBWTtnQkFDcEQsT0FBT0osSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7Z0JBQ1g7WUFDRjtZQUVBLE1BQU1DLFFBQVFQLFdBQVdRLFNBQVMsQ0FBQyxJQUFJLDBCQUEwQjtZQUVqRSxtQkFBbUI7WUFDbkIsTUFBTUMsVUFBVWYsMERBQVUsQ0FBQ2EsT0FBT0ksNENBQXNCLElBQUk7WUFFNUQsSUFBSSxDQUFDRixXQUFXLENBQUNBLFFBQVFLLEVBQUUsRUFBRTtnQkFDM0IsT0FBT2YsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7Z0JBQ1g7WUFDRjtZQUVBLDJCQUEyQjtZQUMzQlIsSUFBSWlCLElBQUksR0FBRztnQkFDVEQsSUFBSUwsUUFBUUssRUFBRTtnQkFDZEUsUUFBUUMsU0FBU1IsUUFBUUssRUFBRSxLQUFLO2dCQUNoQ0ksT0FBT1QsUUFBUVMsS0FBSyxJQUFJO2dCQUN4QkMsTUFBTVYsUUFBUVUsSUFBSSxJQUFJO2dCQUN0QkMsTUFBTVgsUUFBUVcsSUFBSSxJQUFJO1lBQ3hCO1lBRUEseUJBQXlCO1lBQ3pCLElBQUl2QixlQUFlO2dCQUNqQixNQUFNd0IsZUFBZUMsTUFBTUMsT0FBTyxDQUFDMUIsaUJBQWlCQSxnQkFBZ0I7b0JBQUNBO2lCQUFjO2dCQUNuRixJQUFJLENBQUN3QixhQUFhRyxRQUFRLENBQUMxQixJQUFJaUIsSUFBSSxDQUFDSyxJQUFJLEdBQUc7b0JBQ3pDLE9BQU9yQixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO3dCQUMxQkMsU0FBUztvQkFDWDtnQkFDRjtZQUNGO1lBRUEsMEJBQTBCO1lBQzFCLE9BQU8sTUFBTVYsUUFBUUUsS0FBS0M7UUFFNUIsRUFBRSxPQUFPMEIsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtZQUN4QyxPQUFPMUIsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDMUJDLFNBQVM7WUFDWDtRQUNGO0lBQ0Y7QUFDRjtBQUVPLFNBQVNxQixjQUNkL0IsT0FBMkU7SUFFM0UsT0FBT0QsU0FBU0MsU0FBUztBQUMzQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FmbXMtbmV4dGpzLy4vbGliL2F1dGgtbWlkZGxld2FyZS50cz84ZTI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcblxuZXhwb3J0IGludGVyZmFjZSBBdXRoZW50aWNhdGVkUmVxdWVzdCBleHRlbmRzIE5leHRBcGlSZXF1ZXN0IHtcbiAgdXNlcj86IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHVzZXJJZDogbnVtYmVyO1xuICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHJvbGU6IHN0cmluZztcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhBdXRoKFxuICBoYW5kbGVyOiAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IFByb21pc2U8dm9pZD4sXG4gIHJlcXVpcmVkUm9sZXM/OiBzdHJpbmcgfCBzdHJpbmdbXVxuKSB7XG4gIHJldHVybiBhc3luYyAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHRva2VuIGZyb20gQXV0aG9yaXphdGlvbiBoZWFkZXJcbiAgICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xuICAgICAgaWYgKCFhdXRoSGVhZGVyIHx8ICFhdXRoSGVhZGVyLnN0YXJ0c1dpdGgoJ0JlYXJlciAnKSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICAgIG1lc3NhZ2U6ICdObyB0b2tlbiBwcm92aWRlZCdcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5zdWJzdHJpbmcoNyk7IC8vIFJlbW92ZSAnQmVhcmVyICcgcHJlZml4XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBKV1QgdG9rZW5cbiAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd5b3VyLXNlY3JldC1rZXknKSBhcyBhbnk7XG4gICAgICBcbiAgICAgIGlmICghZGVjb2RlZCB8fCAhZGVjb2RlZC5pZCkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHRva2VuJ1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHVzZXIgaW5mbyB0byByZXF1ZXN0XG4gICAgICByZXEudXNlciA9IHtcbiAgICAgICAgaWQ6IGRlY29kZWQuaWQsXG4gICAgICAgIHVzZXJJZDogcGFyc2VJbnQoZGVjb2RlZC5pZCkgfHwgMSxcbiAgICAgICAgZW1haWw6IGRlY29kZWQuZW1haWwgfHwgJycsXG4gICAgICAgIG5hbWU6IGRlY29kZWQubmFtZSB8fCAnJyxcbiAgICAgICAgcm9sZTogZGVjb2RlZC5yb2xlIHx8ICdhZG1pbidcbiAgICAgIH07XG5cbiAgICAgIC8vIENoZWNrIHJvbGUgaWYgcmVxdWlyZWRcbiAgICAgIGlmIChyZXF1aXJlZFJvbGVzKSB7XG4gICAgICAgIGNvbnN0IGFsbG93ZWRSb2xlcyA9IEFycmF5LmlzQXJyYXkocmVxdWlyZWRSb2xlcykgPyByZXF1aXJlZFJvbGVzIDogW3JlcXVpcmVkUm9sZXNdO1xuICAgICAgICBpZiAoIWFsbG93ZWRSb2xlcy5pbmNsdWRlcyhyZXEudXNlci5yb2xlKSkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGwgdGhlIGFjdHVhbCBoYW5kbGVyXG4gICAgICByZXR1cm4gYXdhaXQgaGFuZGxlcihyZXEsIHJlcyk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQXV0aCBtaWRkbGV3YXJlIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHRva2VuJ1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd2l0aEFkbWluQXV0aChcbiAgaGFuZGxlcjogKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiBQcm9taXNlPHZvaWQ+XG4pIHtcbiAgcmV0dXJuIHdpdGhBdXRoKGhhbmRsZXIsICdhZG1pbicpO1xufSJdLCJuYW1lcyI6WyJqd3QiLCJ3aXRoQXV0aCIsImhhbmRsZXIiLCJyZXF1aXJlZFJvbGVzIiwicmVxIiwicmVzIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwic3RhcnRzV2l0aCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwidG9rZW4iLCJzdWJzdHJpbmciLCJkZWNvZGVkIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJpZCIsInVzZXIiLCJ1c2VySWQiLCJwYXJzZUludCIsImVtYWlsIiwibmFtZSIsInJvbGUiLCJhbGxvd2VkUm9sZXMiLCJBcnJheSIsImlzQXJyYXkiLCJpbmNsdWRlcyIsImVycm9yIiwiY29uc29sZSIsIndpdGhBZG1pbkF1dGgiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/auth-middleware.ts\n");

/***/ }),

/***/ "(api)/./pages/api/devices/sync.ts":
/*!***********************************!*\
  !*** ./pages/api/devices/sync.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_auth_middleware__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/auth-middleware */ \"(api)/./lib/auth-middleware.ts\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_1__.PrismaClient();\nasync function handler(req, res) {\n    try {\n        switch(req.method){\n            case \"POST\":\n                const { device_id, status, firmware_version, last_heartbeat, error_message, employee_count, storage_usage } = req.body;\n                if (!device_id || !status) {\n                    return res.status(400).json({\n                        success: false,\n                        message: \"Required fields: device_id, status\"\n                    });\n                }\n                // Find device by device_id\n                const device = await prisma.device.findFirst({\n                    where: {\n                        device_id\n                    }\n                });\n                if (!device) {\n                    return res.status(404).json({\n                        success: false,\n                        message: \"Device not found\"\n                    });\n                }\n                // Update device status and sync information\n                const updatedDevice = await prisma.device.update({\n                    where: {\n                        id: device.id\n                    },\n                    data: {\n                        status: status === \"online\" ? \"aktif\" : status === \"offline\" ? \"nonaktif\" : \"maintenance\",\n                        last_sync: new Date(),\n                        ...firmware_version && {\n                            firmware_version\n                        },\n                        ...error_message && {\n                            keterangan: error_message\n                        }\n                    }\n                });\n                // Create or update device status log\n                await prisma.deviceStatusLog.create({\n                    data: {\n                        device_id: device.id,\n                        status,\n                        firmware_version: firmware_version || device.firmware_version,\n                        error_message,\n                        employee_count: employee_count || 0,\n                        storage_usage: storage_usage || 0,\n                        timestamp: new Date()\n                    }\n                });\n                return res.status(200).json({\n                    success: true,\n                    message: \"Device sync successful\",\n                    data: {\n                        device_id: updatedDevice.device_id,\n                        status: updatedDevice.status,\n                        last_sync: updatedDevice.last_sync\n                    }\n                });\n            case \"GET\":\n                // Get sync status for all devices or specific device\n                const { device_id: queryDeviceId, hours = 24 } = req.query;\n                const hoursNum = parseInt(hours.toString());\n                const since = new Date(Date.now() - hoursNum * 60 * 60 * 1000);\n                let whereClause = {\n                    timestamp: {\n                        gte: since\n                    }\n                };\n                if (queryDeviceId) {\n                    const device = await prisma.device.findFirst({\n                        where: {\n                            device_id: queryDeviceId.toString()\n                        }\n                    });\n                    if (!device) {\n                        return res.status(404).json({\n                            success: false,\n                            message: \"Device not found\"\n                        });\n                    }\n                    whereClause.device_id = device.id;\n                }\n                const statusLogs = await prisma.deviceStatusLog.findMany({\n                    where: whereClause,\n                    include: {\n                        device: {\n                            select: {\n                                device_id: true,\n                                nama: true,\n                                tipe: true,\n                                cabang: {\n                                    select: {\n                                        nama: true\n                                    }\n                                }\n                            }\n                        }\n                    },\n                    orderBy: {\n                        timestamp: \"desc\"\n                    }\n                });\n                // Group by device and get latest status\n                const deviceStatuses = statusLogs.reduce((acc, log)=>{\n                    const deviceId = log.device.device_id;\n                    if (!acc[deviceId]) {\n                        acc[deviceId] = {\n                            device_id: deviceId,\n                            nama: log.device.nama,\n                            tipe: log.device.tipe,\n                            cabang: log.device.cabang.nama,\n                            latest_status: log.status,\n                            latest_sync: log.timestamp,\n                            firmware_version: log.firmware_version,\n                            employee_count: log.employee_count,\n                            storage_usage: log.storage_usage,\n                            error_message: log.error_message,\n                            sync_history: []\n                        };\n                    }\n                    acc[deviceId].sync_history.push({\n                        status: log.status,\n                        timestamp: log.timestamp,\n                        error_message: log.error_message\n                    });\n                    return acc;\n                }, {});\n                return res.status(200).json({\n                    success: true,\n                    data: Object.values(deviceStatuses)\n                });\n            default:\n                return res.status(405).json({\n                    success: false,\n                    message: \"Method not allowed\"\n                });\n        }\n    } catch (error) {\n        console.error(\"Device sync API error:\", error);\n        return res.status(500).json({\n            success: false,\n            message: \"Internal server error\"\n        });\n    } finally{\n        await prisma.$disconnect();\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_auth_middleware__WEBPACK_IMPORTED_MODULE_0__.withAdminAuth)(handler));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWV5QyxJQUFJekMsYUFBYTtvQkFDbEM7b0JBRUEsT0FBT3dDO2dCQUNULEdBQUcsQ0FBQztnQkFFSixPQUFPOUMsSUFBSUcsTUFBTSxDQUFDLEtBQUtPLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7b0JBQ1RRLE1BQU1rQyxPQUFPQyxNQUFNLENBQUNWO2dCQUN0QjtZQUVGO2dCQUNFLE9BQU81QyxJQUFJRyxNQUFNLENBQUMsS0FBS08sSUFBSSxDQUFDO29CQUMxQkMsU0FBUztvQkFDVEMsU0FBUztnQkFDWDtRQUNKO0lBRUYsRUFBRSxPQUFPMkMsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxPQUFPdkQsSUFBSUcsTUFBTSxDQUFDLEtBQUtPLElBQUksQ0FBQztZQUMxQkMsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRixTQUFVO1FBQ1IsTUFBTWYsT0FBTzRELFdBQVc7SUFDMUI7QUFDRjtBQUVBLGlFQUFlOUQsbUVBQWFBLENBQUNHLFFBQVFBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZm1zLW5leHRqcy8uL3BhZ2VzL2FwaS9kZXZpY2VzL3N5bmMudHM/MDQ4YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IHdpdGhBZG1pbkF1dGgsIEF1dGhlbnRpY2F0ZWRSZXF1ZXN0IH0gZnJvbSAnLi4vLi4vLi4vbGliL2F1dGgtbWlkZGxld2FyZSc7XG5pbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5cbmNvbnN0IHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcblxuaW50ZXJmYWNlIFN5bmNSZXF1ZXN0IHtcbiAgZGV2aWNlX2lkOiBzdHJpbmc7XG4gIHN0YXR1czogJ29ubGluZScgfCAnb2ZmbGluZScgfCAnZXJyb3InO1xuICBmaXJtd2FyZV92ZXJzaW9uPzogc3RyaW5nO1xuICBsYXN0X2hlYXJ0YmVhdD86IHN0cmluZztcbiAgZXJyb3JfbWVzc2FnZT86IHN0cmluZztcbiAgZW1wbG95ZWVfY291bnQ/OiBudW1iZXI7XG4gIHN0b3JhZ2VfdXNhZ2U/OiBudW1iZXI7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlXG4pIHtcbiAgdHJ5IHtcbiAgICBzd2l0Y2ggKHJlcS5tZXRob2QpIHtcbiAgICAgIGNhc2UgJ1BPU1QnOlxuICAgICAgICBjb25zdCB7IGRldmljZV9pZCwgc3RhdHVzLCBmaXJtd2FyZV92ZXJzaW9uLCBsYXN0X2hlYXJ0YmVhdCwgZXJyb3JfbWVzc2FnZSwgZW1wbG95ZWVfY291bnQsIHN0b3JhZ2VfdXNhZ2UgfSA9IHJlcS5ib2R5IGFzIFN5bmNSZXF1ZXN0O1xuICAgICAgICBcbiAgICAgICAgaWYgKCFkZXZpY2VfaWQgfHwgIXN0YXR1cykge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdSZXF1aXJlZCBmaWVsZHM6IGRldmljZV9pZCwgc3RhdHVzJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kIGRldmljZSBieSBkZXZpY2VfaWRcbiAgICAgICAgY29uc3QgZGV2aWNlID0gYXdhaXQgcHJpc21hLmRldmljZS5maW5kRmlyc3Qoe1xuICAgICAgICAgIHdoZXJlOiB7IGRldmljZV9pZCB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFkZXZpY2UpIHtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBtZXNzYWdlOiAnRGV2aWNlIG5vdCBmb3VuZCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIGRldmljZSBzdGF0dXMgYW5kIHN5bmMgaW5mb3JtYXRpb25cbiAgICAgICAgY29uc3QgdXBkYXRlZERldmljZSA9IGF3YWl0IHByaXNtYS5kZXZpY2UudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogZGV2aWNlLmlkIH0sXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMgPT09ICdvbmxpbmUnID8gJ2FrdGlmJyA6IHN0YXR1cyA9PT0gJ29mZmxpbmUnID8gJ25vbmFrdGlmJyA6ICdtYWludGVuYW5jZScsXG4gICAgICAgICAgICBsYXN0X3N5bmM6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAuLi4oZmlybXdhcmVfdmVyc2lvbiAmJiB7IGZpcm13YXJlX3ZlcnNpb24gfSksXG4gICAgICAgICAgICAuLi4oZXJyb3JfbWVzc2FnZSAmJiB7IGtldGVyYW5nYW46IGVycm9yX21lc3NhZ2UgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIG9yIHVwZGF0ZSBkZXZpY2Ugc3RhdHVzIGxvZ1xuICAgICAgICBhd2FpdCBwcmlzbWEuZGV2aWNlU3RhdHVzTG9nLmNyZWF0ZSh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZGV2aWNlX2lkOiBkZXZpY2UuaWQsXG4gICAgICAgICAgICBzdGF0dXMsXG4gICAgICAgICAgICBmaXJtd2FyZV92ZXJzaW9uOiBmaXJtd2FyZV92ZXJzaW9uIHx8IGRldmljZS5maXJtd2FyZV92ZXJzaW9uLFxuICAgICAgICAgICAgZXJyb3JfbWVzc2FnZSxcbiAgICAgICAgICAgIGVtcGxveWVlX2NvdW50OiBlbXBsb3llZV9jb3VudCB8fCAwLFxuICAgICAgICAgICAgc3RvcmFnZV91c2FnZTogc3RvcmFnZV91c2FnZSB8fCAwLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBtZXNzYWdlOiAnRGV2aWNlIHN5bmMgc3VjY2Vzc2Z1bCcsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZGV2aWNlX2lkOiB1cGRhdGVkRGV2aWNlLmRldmljZV9pZCxcbiAgICAgICAgICAgIHN0YXR1czogdXBkYXRlZERldmljZS5zdGF0dXMsXG4gICAgICAgICAgICBsYXN0X3N5bmM6IHVwZGF0ZWREZXZpY2UubGFzdF9zeW5jXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSAnR0VUJzpcbiAgICAgICAgLy8gR2V0IHN5bmMgc3RhdHVzIGZvciBhbGwgZGV2aWNlcyBvciBzcGVjaWZpYyBkZXZpY2VcbiAgICAgICAgY29uc3QgeyBkZXZpY2VfaWQ6IHF1ZXJ5RGV2aWNlSWQsIGhvdXJzID0gMjQgfSA9IHJlcS5xdWVyeTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGhvdXJzTnVtID0gcGFyc2VJbnQoaG91cnMudG9TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IHNpbmNlID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGhvdXJzTnVtICogNjAgKiA2MCAqIDEwMDApO1xuICAgICAgICBcbiAgICAgICAgbGV0IHdoZXJlQ2xhdXNlOiBhbnkgPSB7XG4gICAgICAgICAgdGltZXN0YW1wOiB7XG4gICAgICAgICAgICBndGU6IHNpbmNlXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgaWYgKHF1ZXJ5RGV2aWNlSWQpIHtcbiAgICAgICAgICBjb25zdCBkZXZpY2UgPSBhd2FpdCBwcmlzbWEuZGV2aWNlLmZpbmRGaXJzdCh7XG4gICAgICAgICAgICB3aGVyZTogeyBkZXZpY2VfaWQ6IHF1ZXJ5RGV2aWNlSWQudG9TdHJpbmcoKSB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKCFkZXZpY2UpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAnRGV2aWNlIG5vdCBmb3VuZCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICB3aGVyZUNsYXVzZS5kZXZpY2VfaWQgPSBkZXZpY2UuaWQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0YXR1c0xvZ3MgPSBhd2FpdCBwcmlzbWEuZGV2aWNlU3RhdHVzTG9nLmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZTogd2hlcmVDbGF1c2UsXG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgZGV2aWNlOiB7XG4gICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgIGRldmljZV9pZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBuYW1hOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRpcGU6IHRydWUsXG4gICAgICAgICAgICAgICAgY2FiYW5nOiB7XG4gICAgICAgICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtYTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3JkZXJCeTogeyB0aW1lc3RhbXA6ICdkZXNjJyB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gR3JvdXAgYnkgZGV2aWNlIGFuZCBnZXQgbGF0ZXN0IHN0YXR1c1xuICAgICAgICBjb25zdCBkZXZpY2VTdGF0dXNlcyA9IHN0YXR1c0xvZ3MucmVkdWNlKChhY2M6IGFueSwgbG9nOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCBkZXZpY2VJZCA9IGxvZy5kZXZpY2UuZGV2aWNlX2lkO1xuICAgICAgICAgIGlmICghYWNjW2RldmljZUlkXSkge1xuICAgICAgICAgICAgYWNjW2RldmljZUlkXSA9IHtcbiAgICAgICAgICAgICAgZGV2aWNlX2lkOiBkZXZpY2VJZCxcbiAgICAgICAgICAgICAgbmFtYTogbG9nLmRldmljZS5uYW1hLFxuICAgICAgICAgICAgICB0aXBlOiBsb2cuZGV2aWNlLnRpcGUsXG4gICAgICAgICAgICAgIGNhYmFuZzogbG9nLmRldmljZS5jYWJhbmcubmFtYSxcbiAgICAgICAgICAgICAgbGF0ZXN0X3N0YXR1czogbG9nLnN0YXR1cyxcbiAgICAgICAgICAgICAgbGF0ZXN0X3N5bmM6IGxvZy50aW1lc3RhbXAsXG4gICAgICAgICAgICAgIGZpcm13YXJlX3ZlcnNpb246IGxvZy5maXJtd2FyZV92ZXJzaW9uLFxuICAgICAgICAgICAgICBlbXBsb3llZV9jb3VudDogbG9nLmVtcGxveWVlX2NvdW50LFxuICAgICAgICAgICAgICBzdG9yYWdlX3VzYWdlOiBsb2cuc3RvcmFnZV91c2FnZSxcbiAgICAgICAgICAgICAgZXJyb3JfbWVzc2FnZTogbG9nLmVycm9yX21lc3NhZ2UsXG4gICAgICAgICAgICAgIHN5bmNfaGlzdG9yeTogW11cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGFjY1tkZXZpY2VJZF0uc3luY19oaXN0b3J5LnB1c2goe1xuICAgICAgICAgICAgc3RhdHVzOiBsb2cuc3RhdHVzLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBsb2cudGltZXN0YW1wLFxuICAgICAgICAgICAgZXJyb3JfbWVzc2FnZTogbG9nLmVycm9yX21lc3NhZ2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCB7fSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogT2JqZWN0LnZhbHVlcyhkZXZpY2VTdGF0dXNlcylcbiAgICAgICAgfSk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6ICdNZXRob2Qgbm90IGFsbG93ZWQnIFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdEZXZpY2Ugc3luYyBBUEkgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXG4gICAgfSk7XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgcHJpc21hLiRkaXNjb25uZWN0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgd2l0aEFkbWluQXV0aChoYW5kbGVyKTsiXSwibmFtZXMiOlsid2l0aEFkbWluQXV0aCIsIlByaXNtYUNsaWVudCIsInByaXNtYSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJkZXZpY2VfaWQiLCJzdGF0dXMiLCJmaXJtd2FyZV92ZXJzaW9uIiwibGFzdF9oZWFydGJlYXQiLCJlcnJvcl9tZXNzYWdlIiwiZW1wbG95ZWVfY291bnQiLCJzdG9yYWdlX3VzYWdlIiwiYm9keSIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsImRldmljZSIsImZpbmRGaXJzdCIsIndoZXJlIiwidXBkYXRlZERldmljZSIsInVwZGF0ZSIsImlkIiwiZGF0YSIsImxhc3Rfc3luYyIsIkRhdGUiLCJrZXRlcmFuZ2FuIiwiZGV2aWNlU3RhdHVzTG9nIiwiY3JlYXRlIiwidGltZXN0YW1wIiwicXVlcnlEZXZpY2VJZCIsImhvdXJzIiwicXVlcnkiLCJob3Vyc051bSIsInBhcnNlSW50IiwidG9TdHJpbmciLCJzaW5jZSIsIm5vdyIsIndoZXJlQ2xhdXNlIiwiZ3RlIiwic3RhdHVzTG9ncyIsImZpbmRNYW55IiwiaW5jbHVkZSIsInNlbGVjdCIsIm5hbWEiLCJ0aXBlIiwiY2FiYW5nIiwib3JkZXJCeSIsImRldmljZVN0YXR1c2VzIiwicmVkdWNlIiwiYWNjIiwibG9nIiwiZGV2aWNlSWQiLCJsYXRlc3Rfc3RhdHVzIiwibGF0ZXN0X3N5bmMiLCJzeW5jX2hpc3RvcnkiLCJwdXNoIiwiT2JqZWN0IiwidmFsdWVzIiwiZXJyb3IiLCJjb25zb2xlIiwiJGRpc2Nvbm5lY3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/devices/sync.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdevices%2Fsync&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdevices%5Csync.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();