"use strict";(()=>{var e={};e.id=7176,e.ids=[7176],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},8866:(e,t,a)=>{a.r(t),a.d(t,{config:()=>c,default:()=>h,routeModule:()=>f});var r={};a.r(r),a.d(r,{default:()=>l});var s=a(1802),o=a(7153),n=a(6249),d=a(3382);let i=e=>{let t=new Date,a=[],r=[],s=[],o=[];switch(e){case"7days":for(let e=6;e>=0;e--){let n=new Date(t);n.setDate(n.getDate()-e),a.push(n.toLocaleDateString("id-ID",{weekday:"short"})),r.push(Math.floor(20*Math.random())+15),s.push(Math.floor(5*Math.random())+1),o.push(Math.floor(3*Math.random()))}break;case"30days":for(let e=29;e>=0;e--){let n=new Date(t);n.setDate(n.getDate()-e),a.push(n.getDate().toString()),r.push(Math.floor(25*Math.random())+20),s.push(Math.floor(8*Math.random())+2),o.push(Math.floor(5*Math.random()))}break;case"3months":for(let e=2;e>=0;e--){let n=new Date(t);n.setMonth(n.getMonth()-e),a.push(n.toLocaleDateString("id-ID",{month:"short"})),r.push(Math.floor(500*Math.random())+400),s.push(Math.floor(100*Math.random())+50),o.push(Math.floor(50*Math.random())+10)}break;default:for(let e=6;e>=0;e--){let n=new Date(t);n.setDate(n.getDate()-e),a.push(n.toLocaleDateString("id-ID",{weekday:"short"})),r.push(Math.floor(20*Math.random())+15),s.push(Math.floor(5*Math.random())+1),o.push(Math.floor(3*Math.random()))}}return{labels:a,datasets:[{label:"Hadir",data:r,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4},{label:"Terlambat",data:s,borderColor:"rgb(251, 146, 60)",backgroundColor:"rgba(251, 146, 60, 0.1)",tension:.4},{label:"Alpha",data:o,borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4}]}};async function u(e,t){if("GET"!==e.method)return t.status(405).json({success:!1,message:"Method not allowed"});try{let{period:a="7days"}=e.query;if(!["7days","30days","3months"].includes(a))return t.status(400).json({success:!1,message:"Invalid period parameter. Valid values: 7days, 30days, 3months"});let r=i(a);return t.status(200).json({success:!0,message:"Data grafik kehadiran berhasil diambil",data:r})}catch(e){return t.status(500).json({success:!1,message:"Terjadi kesalahan server",error:e.message})}}let l=(0,d.Q)(u),h=(0,n.l)(r,"default"),c=(0,n.l)(r,"config"),f=new s.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/dasbor/attendance-chart",pathname:"/api/dasbor/attendance-chart",bundlePath:"",filename:""},userland:r})},3382:(e,t,a)=>{a.d(t,{Q:()=>o,c:()=>n});var r=a(9344),s=a.n(r);function o(e,t){return async(a,r)=>{try{let o=a.headers.authorization;if(!o||!o.startsWith("Bearer "))return r.status(401).json({message:"No token provided"});let n=o.substring(7),d=s().verify(n,"afms-production-jwt-secret-key-2024-ultra-secure-random-string-xyz789");if(!d||!d.id)return r.status(401).json({message:"Token tidak valid"});if(a.user={id:d.id,userId:parseInt(d.id)||1,email:d.email||"",name:d.name||"",role:d.role||"admin"},t&&!(Array.isArray(t)?t:[t]).includes(a.user.role))return r.status(403).json({message:"Insufficient permissions"});return await e(a,r)}catch(e){return r.status(401).json({message:"Token tidak valid"})}}}function n(e){return o(e,"admin")}},7153:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(e,t,a)=>{e.exports=a(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var a=t(t.s=8866);module.exports=a})();