"use strict";(()=>{var a={};a.id=514,a.ids=[514],a.modules={9344:a=>{a.exports=require("jsonwebtoken")},145:a=>{a.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(a,e)=>{Object.defineProperty(e,"l",{enumerable:!0,get:function(){return function a(e,t){return t in e?e[t]:"then"in e&&"function"==typeof e.then?e.then(e=>a(e,t)):"function"==typeof e&&"default"===t?e:void 0}}})},5214:(a,e,t)=>{t.r(e),t.d(e,{config:()=>g,default:()=>c,routeModule:()=>f});var n={};t.r(n),t.d(n,{default:()=>m});var r=t(1802),s=t(7153),i=t(6249),o=t(3382);let u=[{id:1,nama:"John Doe",email:"john@afms.com",jabatan_id:1,jabatan:{nama:"Manager"},cabang_id:1,cabang:{nama:"Cabang Utama"},telepon:"081234567890",alamat:"Jl. Contoh No. 123",tanggal_masuk:"2023-01-15",fingerprint_id:"FP001",status:"aktif",created_at:"2023-01-15T00:00:00.000Z",updated_at:"2023-01-15T00:00:00.000Z"},{id:2,nama:"Jane Smith",email:"jane@afms.com",jabatan_id:2,jabatan:{nama:"Staff"},cabang_id:1,cabang:{nama:"Cabang Utama"},telepon:"081234567891",alamat:"Jl. Contoh No. 124",tanggal_masuk:"2023-02-01",fingerprint_id:"FP002",status:"aktif",created_at:"2023-02-01T00:00:00.000Z",updated_at:"2023-02-01T00:00:00.000Z"}],d=3;async function l(a,e){try{switch(a.method){case"GET":let{page:t=1,limit:n=10,search:r="",cabang_id:s,jabatan_id:i}=a.query,o=[...u];r&&(o=o.filter(a=>a.nama.toLowerCase().includes(r.toString().toLowerCase())||a.email.toLowerCase().includes(r.toString().toLowerCase()))),s&&(o=o.filter(a=>a.cabang_id===parseInt(s.toString()))),i&&(o=o.filter(a=>a.jabatan_id===parseInt(i.toString())));let l=parseInt(t.toString()),m=parseInt(n.toString()),c=(l-1)*m,g=o.slice(c,c+m);return e.status(200).json({success:!0,data:g,pagination:{current_page:l,per_page:m,total:o.length,total_pages:Math.ceil(o.length/m)}});case"POST":let{nama:f,email:p,jabatan_id:_,cabang_id:b,telepon:j,alamat:P,tanggal_masuk:h,finger_id:S,status:y}=a.body;if(!f||!p||!_||!b)return e.status(400).json({message:"Required fields: nama, email, jabatan_id, cabang_id"});if(u.find(a=>a.email===p))return e.status(400).json({message:"Email already exists"});let I={id:d++,nama:f,email:p,jabatan_id:parseInt(_),jabatan:{nama:"Staff"},cabang_id:parseInt(b),cabang:{nama:"Cabang Utama"},telepon:j||"",alamat:P||"",tanggal_masuk:h||new Date().toISOString().split("T")[0],fingerprint_id:S||null,status:y||"aktif",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return u.push(I),e.status(201).json({success:!0,message:"Karyawan created successfully",data:I});default:return e.status(405).json({message:"Method not allowed"})}}catch(a){return e.status(500).json({message:"Internal server error"})}}let m=(0,o.c)(l),c=(0,i.l)(n,"default"),g=(0,i.l)(n,"config"),f=new r.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/karyawan",pathname:"/api/karyawan",bundlePath:"",filename:""},userland:n})},3382:(a,e,t)=>{t.d(e,{Q:()=>s,c:()=>i});var n=t(9344),r=t.n(n);function s(a,e){return async(t,n)=>{try{let s=t.headers.authorization;if(!s||!s.startsWith("Bearer "))return n.status(401).json({message:"No token provided"});let i=s.substring(7),o=r().verify(i,"your-super-secret-jwt-key-here-development");if(!o||!o.id)return n.status(401).json({message:"Invalid token"});if(t.user={id:o.id,userId:parseInt(o.id)||1,email:o.email||"",name:o.name||"",role:o.role||"admin"},e&&!(Array.isArray(e)?e:[e]).includes(t.user.role))return n.status(403).json({message:"Insufficient permissions"});return await a(t,n)}catch(a){return n.status(401).json({message:"Invalid token"})}}}function i(a){return s(a,"admin")}},7153:(a,e)=>{var t;Object.defineProperty(e,"x",{enumerable:!0,get:function(){return t}}),function(a){a.PAGES="PAGES",a.PAGES_API="PAGES_API",a.APP_PAGE="APP_PAGE",a.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(a,e,t)=>{a.exports=t(145)}};var e=require("../../webpack-api-runtime.js");e.C(a);var t=e(e.s=5214);module.exports=t})();